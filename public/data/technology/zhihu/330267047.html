<h2>凸二次优化问题</h2><p data-pid="xq7wpo-L"><b>Theory.</b> 设<img src="https://www.zhihu.com/equation?tex=A%5Cin+R%5E%7Bn%5Ctimes+n%7D" alt="A\in R^{n\times n}" eeimg="1">是实对称正定矩阵，<img src="https://www.zhihu.com/equation?tex=b%5Cin+R%5En" alt="b\in R^n" eeimg="1">，则求解凸二次优化问题</p><p data-pid="lfSxp180"><img src="https://www.zhihu.com/equation?tex=%5Cmin+f%28x%29%3D%5Cfrac%7B1%7D%7B2%7D+x%5E%7BT%7D+A+x-b%5E%7BT%7D+x%5C%5C" alt="\min f(x)=\frac{1}{2} x^{T} A x-b^{T} x\\" eeimg="1"></p><p data-pid="ZiUyhzDV">等价于求解线性方程组<img src="https://www.zhihu.com/equation?tex=Ax%3Db" alt="Ax=b" eeimg="1">。</p><p data-pid="rUb-hB2L"><b>Proof.</b>   二次型二阶可导，极小值点处梯度为零，现对优化的目标函数求梯度。二次型本质上具有：</p><p data-pid="nFVOwx1p"><img src="https://www.zhihu.com/equation?tex=f%28x%29%3D%5Cfrac%7B1%7D%7B2%7D+x%5E%7BT%7D+A+x-b%5E%7BT%7D%3D%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi%3Dj%7Da_%7Bii%7Dx_i%5E2%2B%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi%5Cneq+j%7Da_%7Bij%7Dx_ix_j-%5Csum_i+b_ix_i%5C%5C" alt="f(x)=\frac{1}{2} x^{T} A x-b^{T}=\frac{1}{2}\sum_{i=j}a_{ii}x_i^2+\frac{1}{2}\sum_{i\neq j}a_{ij}x_ix_j-\sum_i b_ix_i\\" eeimg="1"></p><p data-pid="N5QO5mUZ">计算梯度的分量表达式：</p><p data-pid="0kF6AhcM"><img src="https://www.zhihu.com/equation?tex=%5Cnabla+f%28x%29_i%3D%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+x_i%7D%3Da_%7Bii%7Dx_i+%2B+%5Csum_%7Bj%5Cneq+i%7Da_%7Bij%7Dx_j-b_i%3D%5Csum_%7Bj%7Da_%7Bij%7Dx_j-b_i%5C%5C" alt="\nabla f(x)_i=\frac{\partial f}{\partial x_i}=a_{ii}x_i + \sum_{j\neq i}a_{ij}x_j-b_i=\sum_{j}a_{ij}x_j-b_i\\" eeimg="1"></p><p data-pid="feE4TN3B">合在一起写成矩阵形式：</p><p data-pid="zeX1R0w5"><img src="https://www.zhihu.com/equation?tex=%5Cnabla+f%28x%29%3DAx-b%3D0%5C%5C" alt="\nabla f(x)=Ax-b=0\\" eeimg="1"></p><p data-pid="1yD9Ys8b">显然，凸二次优化问题的极值条件等价于该线性方程组。凸二次优化问题在建模中十分常见，这说明讨论线性方程组的求解方法具有普遍的实用价值。然而对于规模较大的问题，使用线性代数中的克莱姆法则暴力展开将导致时间开销巨大，而高斯消元法算法流程又较为复杂。本文将介绍一种常见的数值分析方法，求得线性方程组的数值近似解。</p><h3>最速梯度下降法</h3><p data-pid="XiJMzX2z">称优化目标函数的梯度为残量（Residue），即是当前解对于线性方程组的不满足量：</p><p data-pid="rycTd2r2"><img src="https://www.zhihu.com/equation?tex=r%28x%29%3DAx-b%5C%5C" alt="r(x)=Ax-b\\" eeimg="1"></p><p data-pid="eF1XTiJK">由于函数是凸函数，极值点一定存在。当前解处函数的梯度值表示了函数值上升最快的方向（梯度方向上方向导数最大）。那么沿着相反的方向每迭代一步就会更加靠近最优的极小值解。于是，我们定义迭代关系：</p><p data-pid="JoHnTvIr"><img src="https://www.zhihu.com/equation?tex=x%5E%7B%28k%2B1%29%7D%3Dx%5E%7B%28k%29%7D-%5Calpha_%7Bk%7D%5Cnabla+f%28x%5E%7B%28k%29%7D%29%3Dx%5E%7B%28k%29%7D-%5Calpha_%7Bk%7D%28A+x%5E%7B%28k%29%7D-b%29%5C%5C" alt="x^{(k+1)}=x^{(k)}-\alpha_{k}\nabla f(x^{(k)})=x^{(k)}-\alpha_{k}(A x^{(k)}-b)\\" eeimg="1"></p><p data-pid="5uqu_m59">其中<img src="https://www.zhihu.com/equation?tex=x%5E%7B%28k%29%7D" alt="x^{(k)}" eeimg="1">表示迭代第<img src="https://www.zhihu.com/equation?tex=k" alt="k" eeimg="1">轮的解，<img src="https://www.zhihu.com/equation?tex=%5Calpha_k" alt="\alpha_k" eeimg="1">表示每轮迭代的步长，即每一步下降多少的权重。之所以需要设计一个与<img src="https://www.zhihu.com/equation?tex=k" alt="k" eeimg="1">相关的步长，是因为随着迭代的进行，梯度是变化的。越靠近驻点的梯度将会越小，直到接近于0时收敛。同时还要考虑在接近于驻点时应该放缓步伐，否则会出现梯度在正负之间频繁震荡，解在最优解左右摇摆的情况。</p><p data-pid="63lg7XkN">在最速下降法中，将<img src="https://www.zhihu.com/equation?tex=x%5E%7B%28k%2B1%29%7D" alt="x^{(k+1)}" eeimg="1">作为自变量代入原函数，并看作<img src="https://www.zhihu.com/equation?tex=%5Calpha_k" alt="\alpha_k" eeimg="1">的函数，对其进行最小化：</p><p data-pid="Qh2ZIXWN"><img src="https://www.zhihu.com/equation?tex=%5Cmin+h%28%5Calpha%29%3Df%28x%5E%7B%28k%2B1%29%7D%29%3Df%28x%5E%7B%28k%29%7D-%5Calpha_%7Bk%7D%28A+x%5E%7B%28k%29%7D-b%29%29%5C%5C" alt="\min h(\alpha)=f(x^{(k+1)})=f(x^{(k)}-\alpha_{k}(A x^{(k)}-b))\\" eeimg="1"></p><p data-pid="vuVUFteL">同样的，驻点处梯度为零。根据链式求导法则：</p><p data-pid="_rCOuQHT"><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%2A%7D+%26%5Cleft.h%5E%7B%5Cprime%7D%28%5Calpha%29%5Cright%7C_%7B%5Calpha%3D%5Calpha_%7Bk%7D%7D%3D%5Cleft%5B%5Cnabla+f%5Cleft%28x%5E%7B%28k%29%7D-%5Calpha_%7Bk%7D%5Cleft%28A+x%5E%7B%28k%29%7D-b%5Cright%29%5Cright%29%5Cright%5D%5E%7BT%7D%5Cleft%28A+x%5E%7B%28k%29%7D-b%5Cright%29%3D0%5C%5C+%26%5CRightarrow+%5Cleft%5BA%5Cleft%28x%5E%7B%28k%29%7D-%5Calpha_%7Bk%7D%5Cleft%28A+x%5E%7B%28k%29%7D-b%5Cright%29%5Cright%29-b%5Cright%5D%5E%7BT%7D%5Cleft%28A+x%5E%7B%28k%29%7D-b%5Cright%29%3D0%5C%5C+%26%5CRightarrow+%5Cleft%28Ax%5E%7B%28k%29%7D-b%5Cright%29%5ET%5Cleft%28Ax%5E%7B%28k%29%7D-b%5Cright%29-%5Cleft%5B%5Calpha_k+A%5Cleft%28Ax%5E%7B%28k%29%7D-b%5Cright%29%5Cright%5D%5ET%5Cleft%28Ax%5E%7B%28k%29%7D-b%5Cright%29%3D0+%5C%5C+%26%5CRightarrow+%5CVert+Ax%5E%7B%28k%29%7D-b+%5CVert%5E2_2-%5Calpha_k+%5Cleft%28Ax%5E%7B%28k%29%7D-b%5Cright%29%5ETA%5ET%5Cleft%28Ax%5E%7B%28k%29%7D-b%5Cright%29%3D0%5C%5C+%26%5CRightarrow+%5Calpha_%7Bk%7D%3D%5Cfrac%7B%5Cleft%5C%7CA+x%5E%7B%28k%29%7D-b%5Cright%5C%7C%5E%7B2%7D%7D%7B%5Cleft%28A+x%5E%7B%28k%29%7D-b%5Cright%29%5E%7BT%7D+A%5Cleft%28A+x%5E%7B%28k%29%7D-b%5Cright%29%7D+%5Cend%7Balign%2A%7D%5C%5C" alt="\begin{align*} &amp;\left.h^{\prime}(\alpha)\right|_{\alpha=\alpha_{k}}=\left[\nabla f\left(x^{(k)}-\alpha_{k}\left(A x^{(k)}-b\right)\right)\right]^{T}\left(A x^{(k)}-b\right)=0\\ &amp;\Rightarrow \left[A\left(x^{(k)}-\alpha_{k}\left(A x^{(k)}-b\right)\right)-b\right]^{T}\left(A x^{(k)}-b\right)=0\\ &amp;\Rightarrow \left(Ax^{(k)}-b\right)^T\left(Ax^{(k)}-b\right)-\left[\alpha_k A\left(Ax^{(k)}-b\right)\right]^T\left(Ax^{(k)}-b\right)=0 \\ &amp;\Rightarrow \Vert Ax^{(k)}-b \Vert^2_2-\alpha_k \left(Ax^{(k)}-b\right)^TA^T\left(Ax^{(k)}-b\right)=0\\ &amp;\Rightarrow \alpha_{k}=\frac{\left\|A x^{(k)}-b\right\|^{2}}{\left(A x^{(k)}-b\right)^{T} A\left(A x^{(k)}-b\right)} \end{align*}\\" eeimg="1"></p><p data-pid="3HPZn80c">最后一步由于<img src="https://www.zhihu.com/equation?tex=A" alt="A" eeimg="1">是正定矩阵，所以分母也是一个正定二次型，值不为零，可以直接除过来。由此，我们最终得到了解的迭代关系：</p><p data-pid="WAc5pppz"><img src="https://www.zhihu.com/equation?tex=x%5E%7B%28k%2B1%29%7D%3Dx%5E%7B%28k%29%7D-%5Cfrac%7B%5Cleft%5C%7CA+x%5E%7B%28k%29%7D-b%5Cright%5C%7C%5E%7B2%7D%7D%7B%5Cleft%28A+x%5E%7B%28k%29%7D-b%5Cright%29%5E%7BT%7D+A%5Cleft%28A+x%5E%7B%28k%29%7D-b%5Cright%29%7D%5Cleft%28A+x%5E%7B%28k%29%7D-b%5Cright%29%5C%5C" alt="x^{(k+1)}=x^{(k)}-\frac{\left\|A x^{(k)}-b\right\|^{2}}{\left(A x^{(k)}-b\right)^{T} A\left(A x^{(k)}-b\right)}\left(A x^{(k)}-b\right)\\" eeimg="1"></p><h3>算例设计与实验</h3><p data-pid="IAeAJmor">参考南科大的数值分析作业题<code>EH计算设计SUSTech</code>的算例一（由于版权关系无传送门）</p><p data-pid="S17g3zuQ"><b>生成实对称正定矩阵</b> 采用文献[1]中的类似方法生成矩阵<img src="https://www.zhihu.com/equation?tex=A" alt="A" eeimg="1">：</p><p data-pid="cEUABUjX"><img src="https://www.zhihu.com/equation?tex=A%3DV%5CSigma+V%5ET%5C%5C" alt="A=V\Sigma V^T\\" eeimg="1"></p><p data-pid="FzcNsxO4">其中<img src="https://www.zhihu.com/equation?tex=V" alt="V" eeimg="1">和<img src="https://www.zhihu.com/equation?tex=%5CSigma" alt="\Sigma" eeimg="1">分别为Householder矩阵和对角矩阵：</p><p data-pid="bf-AO_xB"><img src="https://www.zhihu.com/equation?tex=V%3DI_n-2%5Cfrac%7Bvv%5ET%7D%7B%5CVert+v%5CVert+%5E2_2%7D%2C+%5Cquad%5CSigma%3Ddiag%28%5Csigma_1%2C+%5Csigma_2%2C%5Cdots%2C%5Csigma_n%29%5C%5C" alt="V=I_n-2\frac{vv^T}{\Vert v\Vert ^2_2}, \quad\Sigma=diag(\sigma_1, \sigma_2,\dots,\sigma_n)\\" eeimg="1"></p><p data-pid="iIK3Mw9t">Householder矩阵是对称正交矩阵，这时，对角矩阵的特征值就是<img src="https://www.zhihu.com/equation?tex=A" alt="A" eeimg="1">的特征值，参考矩阵的正交分解。取：</p><p data-pid="ctY7soWe"><img src="https://www.zhihu.com/equation?tex=%5Csigma_i+%3D+cos%5Cfrac%7Bi%5Cpi%7D%7Bn%2B1%7D%2B1%2B%5Ctau%2C%5Cquad+i%3D1%2C%5Cdots%2Cn%5C%5C" alt="\sigma_i = cos\frac{i\pi}{n+1}+1+\tau,\quad i=1,\dots,n\\" eeimg="1"></p><p data-pid="5sp338Pl"><b>推导条件数计算公式</b> 矩阵<img src="https://www.zhihu.com/equation?tex=A" alt="A" eeimg="1">的最大特征值和最小特征值分别为：</p><p data-pid="yfkC1Mvu"><img src="https://www.zhihu.com/equation?tex=e_%7Bmax%7D%3Dcos%5Cfrac%7Bn%5Cpi%7D%7Bn%2B1%7D%2B1%2B%5Ctau%2C%5Cquad+e_%7Bmin%7D%3Dcos%5Cfrac%7B%5Cpi%7D%7Bn%2B1%7D%2B1%2B%5Ctau%5C%5C" alt="e_{max}=cos\frac{n\pi}{n+1}+1+\tau,\quad e_{min}=cos\frac{\pi}{n+1}+1+\tau\\" eeimg="1"></p><p data-pid="kJXP948M">那么其特征值介于<img src="https://www.zhihu.com/equation?tex=%28%5Ctau%2C+%5Ctau%2B2%29" alt="(\tau, \tau+2)" eeimg="1">之间，对称正定矩阵的条件数公式为</p><p data-pid="oY_Hi8NZ"><img src="https://www.zhihu.com/equation?tex=cond%28A%29%3D%5Cfrac%7Be_%7Bmax%7D%7D%7Be_%7Bmin%7D%7D%3D%5Cfrac%7Bcos%5Cfrac%7B%5Cpi%7D%7Bn%2B1%7D%2B1%2B%5Ctau%7D%7Bcos%5Cfrac%7Bn%5Cpi%7D%7Bn%2B1%7D%2B1%2B%5Ctau%7D%5C%5C" alt="cond(A)=\frac{e_{max}}{e_{min}}=\frac{cos\frac{\pi}{n+1}+1+\tau}{cos\frac{n\pi}{n+1}+1+\tau}\\" eeimg="1"></p><p data-pid="X28upCx6">于是可以反解处条件数的计算公式：</p><p data-pid="PAJC2Zlb"><img src="https://www.zhihu.com/equation?tex=%5Ctau+%3D+%5Cfrac%7B%5Cleft%28cos%5Cfrac%7B%5Cpi%7D%7Bn%2B1%7D%2B1%5Cright%29-cond%28A%29%5Cleft%28cos%5Cfrac%7Bn%5Cpi%7D%7Bn%2B1%7D%2B1%5Cright%29%7D%7Bcond%28A%29-1%7D%5C%5C" alt="\tau = \frac{\left(cos\frac{\pi}{n+1}+1\right)-cond(A)\left(cos\frac{n\pi}{n+1}+1\right)}{cond(A)-1}\\" eeimg="1"></p><p data-pid="ly6xq8RM">为了能够重复试验数据，使用<a href="http://link.zhihu.com/?target=https%3A//blog.shinelee.me/2018/08-22-%25E4%25BC%25AA%25E9%259A%258F%25E6%259C%25BA%25E6%2595%25B0%25E7%2594%259F%25E6%2588%2590%25E7%25AE%2597%25E6%25B3%2595.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">线性同余法</a>计算伪随机数进行向量的初始化（也可以使用相同的随机种子，调用编程语言内部的随机值库，这里尊重南科大的原题要求）。令xopt表示最优解<img src="https://www.zhihu.com/equation?tex=x%5E%2A" alt="x^*" eeimg="1">，x0表示解的初始向量<img src="https://www.zhihu.com/equation?tex=x%5E%7B%280%29%7D" alt="x^{(0)}" eeimg="1">。伪随机数算法参数给定如下面MATLAB程序所示：</p><div class="highlight"><pre><code class="language-matlab"><span></span><span class="n">v</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">xopt</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">x0</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span><span class="n"> for </span><span class="s">j = 1: n t = mod(t * 31416 + 13846, 46261)</span><span class="p">;</span> <span class="n">v</span><span class="p">(</span><span class="nb">j</span><span class="p">)</span> <span class="p">=</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">46261</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="k">end</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span><span class="n"> for </span><span class="s">j = 1: n t = mod(t * 42108 + 13846, 46273)</span><span class="p">;</span> <span class="n">xopt</span><span class="p">(</span><span class="nb">j</span><span class="p">)</span> <span class="p">=</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">46273</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span> <span class="k">end</span><span class="p">;</span><span class="n"></span>
<span class="n">       for </span><span class="s">j = 1: n t = mod(t * 42108 + 13846, 46273)</span><span class="p">;</span> <span class="n">x0</span><span class="p">(</span><span class="nb">j</span><span class="p">)</span> <span class="p">=</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">46273</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">;</span> <span class="k">end</span><span class="p">;</span>
</code></pre></div><p data-pid="goSqBVMY">这里设定最优解的分量在<img src="https://www.zhihu.com/equation?tex=%285%2C10%29" alt="(5,10)" eeimg="1">之间，不为零的初始向量分量在<img src="https://www.zhihu.com/equation?tex=%28-10%2C-5%29" alt="(-10,-5)" eeimg="1">之间。根据以上公式可以根据向量<img src="https://www.zhihu.com/equation?tex=v" alt="v" eeimg="1">得到矩阵<img src="https://www.zhihu.com/equation?tex=A" alt="A" eeimg="1">的值，其后使用<img src="https://www.zhihu.com/equation?tex=b%3DAx%5E%2A" alt="b=Ax^*" eeimg="1">计算得到向量<img src="https://www.zhihu.com/equation?tex=b" alt="b" eeimg="1">的值。这时将<img src="https://www.zhihu.com/equation?tex=A" alt="A" eeimg="1">和<img src="https://www.zhihu.com/equation?tex=b" alt="b" eeimg="1">作为问题的给定参数，x0作为初始向量，使用梯度下降的方式计算xk，并计算它与最优解的真值之间的相对误差：</p><p data-pid="7bRb5kQ7"><img src="https://www.zhihu.com/equation?tex=err%3D%5Cleft%5C%7Cx%5E%7Bk%7D-x%5E%7B%2A%7D%5Cright%5C%7C+%2F%5Cleft%5C%7Cx%5E%7B0%7D-x%5E%7B%2A%7D%5Cright%5C%7C%5C%5C" alt="err=\left\|x^{k}-x^{*}\right\| /\left\|x^{0}-x^{*}\right\|\\" eeimg="1"></p><p data-pid="-TUUrwsJ">这里设定算法的停机标准为当前梯度变为接近于零的极小量：</p><p data-pid="7jxrWH5X"><img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5CVert+Ax%5E%7B%28k%29%7D-b%5CVert%7D%7B%5CVert+Ax%5E%7B%28k%29%7D-b%5CVert%7D%5Cleq+10%5E%7B-6%7D%5C%5C" alt="\frac{\Vert Ax^{(k)}-b\Vert}{\Vert Ax^{(k)}-b\Vert}\leq 10^{-6}\\" eeimg="1"></p><p data-pid="rMNzm61R"><b>Python程序代码</b></p><div class="highlight"><pre><code class="language-python"><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">numb</span><span class="p">):</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="n">numb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">cond</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">numb</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="n">numb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">cond</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">cond</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">diags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="n">numb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">numb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))))</span>
    <span class="n">SIGMA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">diags</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numb</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">xopt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numb</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numb</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numb</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">31416</span> <span class="o">+</span> <span class="mi">13846</span><span class="p">)</span> <span class="o">%</span> <span class="mi">46261</span>
        <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">46261</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numb</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">42108</span> <span class="o">+</span> <span class="mi">13846</span><span class="p">)</span> <span class="o">%</span> <span class="mi">46273</span>
        <span class="n">xopt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">46273</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numb</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">42108</span> <span class="o">+</span> <span class="mi">13846</span><span class="p">)</span> <span class="o">%</span> <span class="mi">46273</span>
        <span class="n">x0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">46273</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">numb</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">v</span> <span class="o">@</span> <span class="n">v</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">V</span> <span class="o">@</span> <span class="n">SIGMA</span> <span class="o">@</span> <span class="n">V</span><span class="o">.</span><span class="n">T</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">A</span> <span class="o">@</span> <span class="n">xopt</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">xopt</span><span class="p">,</span> <span class="n">x0</span>

<span class="k">def</span> <span class="nf">gradientDescent</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">):</span>
    <span class="n">x_now</span> <span class="o">=</span> <span class="n">x0</span><span class="p">;</span> <span class="n">epoch</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">gnorm</span> <span class="o">=</span> <span class="n">ginit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span> <span class="o">@</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">gnorm</span> <span class="o">/</span> <span class="n">ginit</span> <span class="o">&gt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="n">g_now</span> <span class="o">=</span> <span class="n">A</span> <span class="o">@</span> <span class="n">x_now</span> <span class="o">-</span> <span class="n">b</span>
        <span class="n">gnorm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">g_now</span><span class="p">)</span>
        <span class="n">xnext</span> <span class="o">=</span> <span class="n">x_now</span> <span class="o">-</span> <span class="p">(</span><span class="n">gnorm</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">g_now</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">A</span> <span class="o">@</span> <span class="n">g_now</span><span class="p">)</span> <span class="o">*</span> <span class="n">g_now</span> <span class="c1"># * LR_linearDecay(epoch)</span>
        <span class="n">x_now</span> <span class="o">=</span> <span class="n">xnext</span>
        <span class="n">epoch</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">x_now</span>

<span class="k">def</span> <span class="nf">LR_linearDecay</span><span class="p">(</span><span class="n">epoch</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span> <span class="n">epoch</span> <span class="o">/</span> <span class="mf">5e4</span> <span class="o">+</span> <span class="mf">0.9</span>

<span class="k">def</span> <span class="nf">LR_expertDecay</span><span class="p">(</span><span class="n">epoch</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">/</span> <span class="mf">4e3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">{:&gt;8}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"EPOCH/ERR"</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">"  "</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"n=</span><span class="si">{:&gt;9}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">n</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">"  "</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"COND=1e+</span><span class="si">{c}</span><span class="s2">"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">" "</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">xopt</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="n">cond</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">c</span><span class="p">,</span> <span class="n">numb</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
            <span class="n">epoch</span><span class="p">,</span> <span class="n">xk</span> <span class="o">=</span> <span class="n">gradientDescent</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">xk</span> <span class="o">-</span> <span class="n">xopt</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">xopt</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">{:&gt;5}</span><span class="s2">/</span><span class="si">{:.4f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">error</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">" "</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
</code></pre></div><p data-pid="XLEe07CJ"><b>MATLAB程序代码</b></p><p data-pid="L5XZIxe6">Linear_init.m</p><div class="highlight"><pre><code class="language-python"><span></span><span class="n">function</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">xopt</span><span class="p">,</span> <span class="n">x0</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_init</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">numb</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="n">numb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">...</span>
          <span class="o">+</span> <span class="n">cond</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">numb</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="n">numb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">cond</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">cond</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">diags</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">numb</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span> <span class="n">numb</span><span class="p">;</span>
        <span class="n">diags</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="n">numb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">;</span>
    <span class="n">end</span><span class="p">;</span>
    <span class="n">SIGMA</span> <span class="o">=</span> <span class="n">diag</span><span class="p">(</span><span class="n">diags</span><span class="p">);</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">numb</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">xopt</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">numb</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">numb</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">t2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span> <span class="n">numb</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">mod</span><span class="p">(</span><span class="n">t1</span> <span class="o">*</span> <span class="mi">31416</span> <span class="o">+</span> <span class="mi">13846</span><span class="p">,</span> <span class="mi">46261</span><span class="p">);</span> 
        <span class="n">v</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">46261</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> 
    <span class="n">end</span><span class="p">;</span>   
    <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span> <span class="n">numb</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">mod</span><span class="p">(</span><span class="n">t2</span> <span class="o">*</span> <span class="mi">42108</span> <span class="o">+</span> <span class="mi">13846</span><span class="p">,</span> <span class="mi">46273</span><span class="p">);</span> 
        <span class="n">xopt</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">t2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">46273</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span> 
    <span class="n">end</span><span class="p">;</span>
    <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span> <span class="n">numb</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">mod</span><span class="p">(</span><span class="n">t2</span> <span class="o">*</span> <span class="mi">42108</span> <span class="o">+</span> <span class="mi">13846</span><span class="p">,</span> <span class="mi">46273</span><span class="p">);</span> 
        <span class="n">x0</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">t2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">46273</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">;</span> 
    <span class="n">end</span><span class="p">;</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="n">numb</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span> <span class="o">*</span> <span class="n">v</span><span class="s1">') / norm(v, 2)^2;</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">V</span> <span class="o">*</span> <span class="n">SIGMA</span> <span class="o">*</span> <span class="n">V</span><span class="s1">';</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">xopt</span><span class="p">;</span>
<span class="n">end</span>
</code></pre></div><p data-pid="gymO5VlK">Linear_solu.m</p><div class="highlight"><pre><code class="language-python"><span></span><span class="n">function</span> <span class="p">[</span><span class="n">epoch</span><span class="p">,</span> <span class="n">x_now</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_solu</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span>
    <span class="n">x_now</span> <span class="o">=</span> <span class="n">x0</span><span class="p">;</span> <span class="n">epoch</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">gnorm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">ginit</span> <span class="o">=</span> <span class="n">gnorm</span><span class="p">;</span>
    <span class="k">while</span> <span class="n">gnorm</span> <span class="o">/</span> <span class="n">ginit</span> <span class="o">&gt;</span> <span class="n">epsilon</span>
        <span class="n">g_now</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">x_now</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span>
        <span class="n">gnorm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">g_now</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
        <span class="n">xnext</span> <span class="o">=</span> <span class="n">x_now</span> <span class="o">-</span> <span class="p">(</span><span class="n">gnorm</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">g_now</span><span class="s1">' * A * g_now) * g_now;</span>
        <span class="n">x_now</span> <span class="o">=</span> <span class="n">xnext</span><span class="p">;</span>
        <span class="n">epoch</span> <span class="o">=</span> <span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">end</span><span class="p">;</span>
<span class="n">end</span>
</code></pre></div><p data-pid="jlrOrfee">Linear_impr.m</p><div class="highlight"><pre><code class="language-python"><span></span><span class="n">function</span> <span class="p">[</span><span class="n">epoch</span><span class="p">,</span> <span class="n">x_now</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_impr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span>
    <span class="n">lr</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span> <span class="o">-</span> <span class="n">epoch</span> <span class="o">/</span> <span class="mf">5e4</span> <span class="o">+</span> <span class="mf">0.9</span><span class="p">;</span>
    <span class="n">x_now</span> <span class="o">=</span> <span class="n">x0</span><span class="p">;</span> <span class="n">epoch</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">gnorm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">ginit</span> <span class="o">=</span> <span class="n">gnorm</span><span class="p">;</span>
    <span class="k">while</span> <span class="n">gnorm</span> <span class="o">/</span> <span class="n">ginit</span> <span class="o">&gt;</span> <span class="n">epsilon</span>
        <span class="n">g_now</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">x_now</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span>
        <span class="n">gnorm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">g_now</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
        <span class="n">xnext</span> <span class="o">=</span> <span class="n">x_now</span> <span class="o">-</span> <span class="n">lr</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">gnorm</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">g_now</span><span class="s1">' * A * g_now) * g_now;</span>
        <span class="n">x_now</span> <span class="o">=</span> <span class="n">xnext</span><span class="p">;</span>
        <span class="n">epoch</span> <span class="o">=</span> <span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">end</span><span class="p">;</span>
<span class="n">end</span>
</code></pre></div><p data-pid="q6sREvJq">Linear_eval.m</p><div class="highlight"><pre><code class="language-python"><span></span><span class="n">function</span> <span class="n">linear_eval</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
<span class="o">%</span> <span class="n">linear_eval</span><span class="p">(</span><span class="s1">'normal'</span><span class="p">)</span> <span class="k">for</span> <span class="n">normal</span> <span class="n">gradient</span> <span class="n">descent</span> <span class="n">algorithm</span>
<span class="o">%</span> <span class="n">linear_eval</span><span class="p">(</span><span class="s1">'improv'</span><span class="p">)</span> <span class="k">for</span> <span class="n">improved</span> <span class="n">radient</span> <span class="n">descent</span> <span class="n">algorithm</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">;</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s1">'</span><span class="si">%8s</span><span class="s1">  '</span><span class="p">,</span> <span class="s1">'EPOCH/ERR'</span><span class="p">);</span>
    <span class="k">for</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="s1">'      n=</span><span class="si">%3d</span><span class="s1">  '</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">n</span><span class="p">);</span>
    <span class="n">end</span><span class="p">;</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">);</span>
    <span class="k">for</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">6</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="s1">'COND=1e+</span><span class="si">%d</span><span class="s1"> '</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
        <span class="k">for</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span>
            <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">xopt</span><span class="p">,</span> <span class="n">x0</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_init</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="n">c</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">n</span><span class="p">);</span>
            <span class="k">if</span> <span class="n">strcmp</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="s1">'improv'</span><span class="p">)</span>
                <span class="p">[</span><span class="n">epoch</span><span class="p">,</span> <span class="n">xk</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_impr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">);</span>
            <span class="k">else</span>
                <span class="p">[</span><span class="n">epoch</span><span class="p">,</span> <span class="n">xk</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_solu</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">);</span>
            <span class="n">end</span><span class="p">;</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">xk</span> <span class="o">-</span> <span class="n">xopt</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">xopt</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
            <span class="n">fprintf</span><span class="p">(</span><span class="s1">'</span><span class="si">%5d</span><span class="s1">/</span><span class="si">%.4f</span><span class="s1"> '</span> <span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
        <span class="n">end</span><span class="p">;</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">);</span>
    <span class="n">end</span><span class="p">;</span>
<span class="n">end</span>
</code></pre></div><p data-pid="yijjcOAQ"><b>实验结果</b></p><div class="highlight"><pre><code class="language-text"><span></span>1
EPOCH/ERR  n=      100  n=      200  n=      300  n=      400  n=      500  
COND=1e+3  3382/0.0786  8910/0.0682 14400/0.0511 15750/0.0492 15696/0.0525 
COND=1e+4  3382/0.0786  8910/0.0682 14400/0.0511 15750/0.0492 15696/0.0525 
COND=1e+5  3382/0.0786  8910/0.0682 14400/0.0511 15750/0.0492 15696/0.0525 
COND=1e+6  3382/0.0786  8910/0.0682 14400/0.0511 15750/0.0492 15696/0.0525 

-epoch / 5e4 + 0.9
EPOCH/ERR  n=      100  n=      200  n=      300  n=      400  n=      500  
COND=1e+3   203/0.0786   459/0.0682   419/0.0510   588/0.0494   544/0.0536 
COND=1e+4   221/0.0786   534/0.0682   855/0.0513   538/0.0494   761/0.0535 
COND=1e+5   203/0.0786   333/0.0682   617/0.0509   538/0.0494   761/0.0535 
COND=1e+6   203/0.0786   534/0.0682   617/0.0509   588/0.0494   544/0.0536

np.exp(- np.log(0.9) * (epoch / 4e3 - 1))
EPOCH/ERR  n=      100  n=      200  n=      300  n=      400  n=      500  
COND=1e+3   287/0.0786   462/0.0682   513/0.0512   579/0.0489   545/0.0535 
COND=1e+4   313/0.0786   531/0.0682   705/0.0512   617/0.0496   710/0.0528 
COND=1e+5   287/0.0786   412/0.0682   619/0.0510   617/0.0496   710/0.0528 
COND=1e+6   287/0.0786   531/0.0682   619/0.0510   579/0.0489   545/0.0535
</code></pre></div><p data-pid="VD9c6x-H"><b>算法变体</b></p><p data-pid="TZyqgLZi">这里清川对原始算法做了一些小改进，在<img src="https://www.zhihu.com/equation?tex=%5Calpha_k" alt="\alpha_k" eeimg="1">前面加上了一个人为设定的二次权重值<img src="https://www.zhihu.com/equation?tex=lr%28k%29" alt="lr(k)" eeimg="1">。实验结果中每部分的第一行代表了<img src="https://www.zhihu.com/equation?tex=lr%28k%29" alt="lr(k)" eeimg="1">的取值方式，表中斜线前面代表停机时的总迭代次数，后面代表相对误差。可以看出，在保持解的精度不变的前提下，加上人工修正的权重使得算法快了30倍。一开始清川想改进成随机梯度下降，但显然他理解错了，SGD算法的随机指的是神经网络训练时每轮迭代选取随机的样本，和这里没有什么关系。但是清川从SGD中采纳了指数衰减和线性衰减的方法，并加以调参就得到了改进。</p><p data-pid="0msoCwZP">这个改进并不能让人喜悦，显然它是在当前数据（矩阵A与b的值）下过拟合的。对于新的数据，该算法未必能够加速。但是这说明了另一个问题：<b>最速下降法并不是最速的</b>。</p><p data-pid="t8epffPP">这是因为这里选取的欧式范数（<img src="https://www.zhihu.com/equation?tex=%5Calpha_k" alt="\alpha_k" eeimg="1">分子上的二范数）并不一定是最合适的衡量标准。每轮迭代总是假设梯度在当前迭代时是近似不变的，以初始位置的梯度模拟整个步长上的梯度，这样并不准确。而清川加了人工调参的二次权重后更好地模拟了梯度的变化，所以更快。如果想进一步实验这一点，可以将<img src="https://www.zhihu.com/equation?tex=%5Calpha_k" alt="\alpha_k" eeimg="1">直接用<img src="https://www.zhihu.com/equation?tex=lr%28k%29" alt="lr(k)" eeimg="1">替换，去调参，预计仍然能得到一个很好的收敛速度。做实验前最好对<img src="https://www.zhihu.com/equation?tex=x" alt="x" eeimg="1">进行归一化，否则调参过程中可能出现数值溢出。关于最速下降法不总是最速的这个结论，也可以参考<a href="http://link.zhihu.com/?target=https%3A//blog.csdn.net/daodaipsrensheng/article/details/81408212" class=" wrap external" target="_blank" rel="nofollow noreferrer">梯度下降法和最速下降法区别</a>。注意本文并未对这两个概念作区分。</p>